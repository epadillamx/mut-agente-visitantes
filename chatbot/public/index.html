<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adium Chile - Asistente Virtual</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #ff0032 0%, #c00028 100%);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
        }

        .page-logo {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
        }

        .page-logo img {
            height: 45px;
            object-fit: contain;
            filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.2));
        }

        .chat-container {
            width: 100%;
            max-width: 800px;
            height: 90vh;
            max-height: 700px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-header {
            background: #ff0032;
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .chat-header h1 {
            font-size: 24px;
            font-weight: 600;
            margin: 0;
        }

        .chat-header p {
            font-size: 14px;
            opacity: 0.9;
            margin: 0;
        }

        .clear-button {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .clear-button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Pesta√±as */
        .tabs-container {
            display: flex;
            background: #f5f5f5;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .tab:hover {
            background: #ebebeb;
        }

        .tab.active {
            color: #ff0032;
            background: white;
            border-bottom: 3px solid #ff0032;
        }

        /* Contenido de pesta√±as */
        .tab-content {
            display: none;
            flex: 1;
            overflow: hidden;
        }

        .tab-content.active {
            display: flex;
            flex-direction: column;
        }

        /* Pesta√±a 1: Chat IA */
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f5f7fb;
        }

        .welcome-message {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .welcome-message h2 {
            color: #ff0032;
            margin-bottom: 10px;
            font-size: 22px;
        }

        .welcome-message p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 5px;
        }

        .message {
            margin-bottom: 20px;
            display: flex;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            justify-content: flex-end;
        }

        .message.assistant {
            justify-content: flex-start;
        }

        .message-content {
            max-width: 70%;
            padding: 12px 18px;
            border-radius: 18px;
            line-height: 1.5;
            word-wrap: break-word;
        }

        .message.user .message-content {
            background: #ff0032;
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message.assistant .message-content {
            background: white;
            color: #333;
            border-bottom-left-radius: 4px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .chat-input-container {
            padding: 20px;
            background: white;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 10px;
            position: relative;
        }

        .clear-button-mobile {
            display: none;
            position: absolute;
            top: -45px;
            right: 20px;
            padding: 8px 12px;
            background: #ff0032;
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(255, 0, 50, 0.3);
            transition: all 0.3s;
        }

        .clear-button-mobile:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 0, 50, 0.4);
        }

        .chat-input {
            flex: 1;
            padding: 12px 18px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 15px;
            outline: none;
            transition: border-color 0.3s;
        }

        .chat-input:focus {
            border-color: #ff0032;
        }

        .send-button {
            padding: 12px 30px;
            background: #ff0032;
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .send-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 0, 50, 0.4);
        }

        .send-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .clear-button-mobile {
            display: none;
            padding: 10px;
            background: #ff0032;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            width: 44px;
            height: 44px;
            transition: transform 0.2s;
            flex-shrink: 0;
        }

        .clear-button-mobile:hover {
            transform: scale(1.1);
        }

        .clear-button-mobile:active {
            transform: scale(0.95);
        }

        .typing-indicator {
            display: none;
            padding: 10px 18px;
            background: white;
            border-radius: 18px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: fit-content;
        }

        .typing-indicator.active {
            display: flex;
            gap: 5px;
            align-items: center;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #ff0032;
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-10px);
            }
        }

        /* Pesta√±a 2: FAQ */
        .faq-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            background: #f5f7fb;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .faq-welcome {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .faq-welcome h2 {
            color: #ff0032;
            margin-bottom: 15px;
            font-size: 28px;
        }

        .faq-welcome p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .faq-welcome .heart {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .test-box {
            display: none;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-height: calc(100vh - 300px);
            overflow-y: auto;
        }

        .test-box.active {
            display: block;
        }

        .test-box h2 {
            color: #ff0032;
            margin-bottom: 10px;
            font-size: 24px;
        }

        .test-box h3 {
            color: #ff0032;
            margin-bottom: 25px;
            font-size: 18px;
            font-weight: 600;
        }

        .test-box p {
            color: #333;
            font-size: 16px;
            line-height: 1.6;
        }

        .consent-content {
            text-align: left;
            padding: 20px;
            background: #f5f7fb;
            border-radius: 10px;
            margin-bottom: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .consent-content h4 {
            color: #ff0032;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .consent-content h4:first-child {
            margin-top: 0;
        }

        .consent-content p {
            margin-bottom: 15px;
            color: #333;
            font-size: 14px;
            line-height: 1.8;
        }

        .consent-content ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .consent-content li {
            margin-bottom: 8px;
            color: #333;
            font-size: 14px;
            line-height: 1.6;
        }

        .consent-fields {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
            margin-bottom: 30px;
        }

        .consent-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background: #f5f7fb;
            border-radius: 10px;
            margin-top: 10px;
        }

        .consent-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .consent-checkbox label {
            font-weight: 600;
            color: #333;
            cursor: pointer;
            font-size: 15px;
            margin: 0;
        }

        .medication-selector {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }

        .medication-button {
            padding: 15px 40px;
            background: #ff0032;
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(255, 0, 50, 0.3);
        }

        .medication-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 0, 50, 0.4);
        }

        .faq-form {
            display: none;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .faq-form.active {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }

        .faq-form h3 {
            color: #ff0032;
            text-align: center;
            margin-bottom: 25px;
            font-size: 22px;
        }

        .form-back-link {
            display: block;
            text-align: left;
            color: #666;
            font-size: 14px;
            margin-bottom: 20px;
            cursor: pointer;
            text-decoration: none;
            transition: color 0.3s;
        }

        .form-back-link:hover {
            color: #ff0032;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #333;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 15px;
        }

        .form-group input {
            width: 100%;
            padding: 12px 18px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 15px;
            outline: none;
            transition: border-color 0.3s;
            box-sizing: border-box;
        }

        .form-group input:focus {
            border-color: #ff0032;
        }

        .form-submit-button {
            width: 100%;
            padding: 15px;
            background: #ff0032;
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .form-submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 0, 50, 0.4);
        }

        .faq-questions {
            display: none;
            flex-direction: column;
            gap: 15px;
        }

        .faq-questions.active {
            display: flex;
        }

        .faq-questions h3 {
            color: #ff0032;
            text-align: center;
            margin-bottom: 10px;
        }

        .faq-question-button {
            padding: 20px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .faq-question-button:hover {
            border-color: #ff0032;
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(255, 0, 50, 0.2);
        }

        .faq-answer {
            display: none;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .faq-answer.active {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }

        .faq-answer h3 {
            color: #ff0032;
            margin-bottom: 20px;
        }

        .faq-answer .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .faq-answer .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .faq-answer p {
            line-height: 1.8;
            color: #666;
            margin-bottom: 15px;
        }

        .faq-answer ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .faq-answer li {
            line-height: 1.8;
            color: #666;
            margin-bottom: 8px;
        }

        .back-button {
            padding: 12px 30px;
            background: #e0e0e0;
            color: #333;
            border: none;
            border-radius: 25px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }

        .back-button:hover {
            background: #d0d0d0;
        }

        .external-link-button {
            display: inline-block;
            padding: 15px 30px;
            background: #ff0032;
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(255, 0, 50, 0.3);
        }

        .external-link-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 0, 50, 0.4);
        }

        /* Responsive */
        @media (max-width: 768px) {
            body {
                padding: 0;
            }

            .page-logo {
                top: 8px;
                left: 8px;
            }

            .page-logo img {
                height: 30px;
            }

            .chat-container {
                max-height: 100vh;
                height: 100vh;
                border-radius: 0;
                max-width: 100%;
            }

            .chat-header {
                padding: 15px;
            }

            .chat-header h1 {
                font-size: 18px;
            }

            .chat-header p {
                font-size: 12px;
            }

            .clear-button {
                display: none;
            }

            .clear-button-mobile {
                display: block;
            }

            .tab {
                padding: 12px 8px;
                font-size: 14px;
            }

            .message-content {
                max-width: 85%;
                font-size: 14px;
            }

            .chat-input {
                font-size: 14px;
                padding: 10px 15px;
            }

            .send-button {
                padding: 10px 20px;
                font-size: 14px;
            }

            .faq-content {
                padding: 15px;
                gap: 15px;
            }

            .faq-welcome {
                padding: 20px;
            }

            .faq-welcome h2 {
                font-size: 24px;
            }

            .faq-welcome p {
                font-size: 14px;
            }

            .medication-button {
                padding: 12px 30px;
                font-size: 16px;
            }

            .faq-questions h3 {
                font-size: 18px;
            }

            .faq-question-button {
                padding: 15px;
                font-size: 15px;
            }

            .faq-answer {
                padding: 20px;
            }

            .faq-answer h3 {
                font-size: 18px;
            }

            .faq-answer p,
            .faq-answer li {
                font-size: 14px;
            }

            .external-link-button {
                padding: 12px 25px;
                font-size: 15px;
            }
        }

        @media (max-width: 480px) {
            .page-logo {
                top: 6px;
                left: 6px;
            }

            .page-logo img {
                height: 25px;
            }

            .chat-header {
                padding: 10px 45px;
            }

            .chat-header h1 {
                font-size: 16px;
            }

            .chat-header p {
                font-size: 11px;
            }

            .clear-button {
                top: 10px;
                right: 6px;
                padding: 5px 8px;
                font-size: 10px;
            }

            .tab {
                padding: 10px 5px;
                font-size: 13px;
            }

            .chat-messages {
                padding: 15px;
            }

            .chat-input-container {
                padding: 15px;
                gap: 8px;
            }

            .message-content {
                font-size: 13px;
                padding: 10px 14px;
            }

            .faq-content {
                padding: 10px;
            }

            .faq-welcome {
                padding: 15px;
            }

            .faq-welcome h2 {
                font-size: 20px;
            }

            .faq-welcome .heart {
                font-size: 28px;
            }

            .medication-button {
                padding: 10px 25px;
                font-size: 15px;
            }

            .faq-questions h3 {
                font-size: 16px;
            }

            .faq-questions p {
                font-size: 13px;
            }

            .faq-question-button {
                padding: 12px;
                font-size: 14px;
            }

            .faq-answer {
                padding: 15px;
            }

            .faq-answer h3 {
                font-size: 16px;
                margin-bottom: 15px;
            }

            .faq-answer p,
            .faq-answer li {
                font-size: 13px;
            }

            .back-button {
                padding: 10px 20px;
                font-size: 14px;
            }

            .external-link-button {
                padding: 10px 20px;
                font-size: 14px;
            }
        }

        @media (max-width: 425px) {
            .page-logo img {
                height: 20px;
            }
        }

        @media (max-width: 360px) {
            .page-logo img {
                height: 18px;
            }

            .chat-header {
                padding: 8px 40px;
            }

            .chat-header h1 {
                font-size: 14px;
            }

            .chat-header p {
                font-size: 10px;
            }

            .clear-button {
                top: 8px;
                right: 5px;
                padding: 4px 6px;
                font-size: 9px;
            }

            .tab {
                font-size: 12px;
                padding: 8px 4px;
            }

            .faq-welcome h2 {
                font-size: 18px;
            }

            .medication-button {
                padding: 8px 20px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <!-- Logo en esquina superior izquierda -->
    <div class="page-logo">
        <img src="/requerimientos/logo-adium-chile-blanco.png" alt="Adium Chile">
    </div>

    <div class="chat-container">
        <!-- Header -->
        <div class="chat-header">
            <h1>Asistente Virtual</h1>
            <p>Programa de apoyo a pacientes</p>
            <button class="clear-button" onclick="clearChat()">üóëÔ∏è Limpiar Chat</button>
        </div>

        <!-- Pesta√±as -->
        <div class="tabs-container">
            <div class="tab active" data-tab="ai">ü§ñ Asistente IA</div>
            <div class="tab" data-tab="faq">ü§ù Programa de Soporte a Paciente</div>
        </div>

        <!-- Contenido Pesta√±a 1: Chat IA -->
        <div class="tab-content active" id="tab-ai">
            <div class="chat-messages" id="chatMessages">
                <div class="welcome-message">
                    <h2>¬°Bienvenido!</h2>
                    <p>Soy tu asistente virtual para responder preguntas sobre <strong>Mounjaro</strong>.</p>
                    <p><em>Escribe tu pregunta para comenzar...</em></p>
                </div>
                <div class="typing-indicator" id="typingIndicator">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>

            <div class="chat-input-container">
                <button class="clear-button-mobile" onclick="clearChat()">üóëÔ∏è</button>
                <input 
                    type="text" 
                    class="chat-input" 
                    id="messageInput" 
                    placeholder="Escribe tu pregunta aqu√≠..."
                    autocomplete="off"
                >
                <button class="send-button" id="sendButton">Enviar</button>
            </div>
        </div>

        <!-- Contenido Pesta√±a 2: FAQ -->
        <div class="tab-content" id="tab-faq">
            <div class="faq-content">
                <!-- Pantalla de bienvenida -->
                <div class="faq-welcome" id="faqWelcome">
                    <div class="heart">‚ù§Ô∏è</div>
                    <h2>¬°Bienvenido!</h2>
                    <p>Gracias por contactarte con el programa de apoyo a pacientes de Adium Chile.</p>
                    <p style="margin-top: 15px; font-weight: 600; color: #333;">Selecciona tu medicamento:</p>
                    <div class="medication-selector">
                        <button class="medication-button" onclick="selectMedication()">MOUNJARO</button>
                    </div>
                </div>

                <!-- Cuadro de prueba -->
                <div class="test-box" id="testBox">
                    <h2>Consentimiento Informado</h2>
                    <h3>Programa de Apoyo a Pacientes</h3>
                    
                    <div class="consent-content">
                        <h4>1. Alcance</h4>
                        <p>El alcance de este consentimiento informado aplica y hace referencia espec√≠fica a la administraci√≥n de Vacunas.</p>
                        
                        <h4>2. Metodolog√≠a</h4>
                        <p>El procedimiento consiste en la administraci√≥n de vacunas solicitada por su m√©dico tratante, por un profesional de la salud.</p>
                        <p>Al momento de la administraci√≥n, el paciente puede sentir dolor, incomodidad y/o puede aparecer inflamaci√≥n y sensibilidad en la zona donde de punci√≥n. Todo el procedimiento no representa ning√∫n riesgo para la salud del paciente.</p>
                        
                        <h4>3. Protecci√≥n de datos personales</h4>
                        <p>Para los fines expuestos, usted entiende y acepta que Serproen, recolectar√° los siguientes datos personales necesarios para la administraci√≥n de vacuna: Nombre, Rut, Edad, Fecha de Nacimiento y Domicilio. Consecuentemente, Serproen podr√° compartir estos datos con los proveedores de vacunas indicados por su m√©dico tratante. Es importante se√±alar que usted no est√° obligado a proporcionar sus datos personales, pero si no los proporciona o si los datos son falsos o inexactos, Serproen no podr√° llevar a cabo la gesti√≥n de inmunizaci√≥n.</p>
                        <p>Serproen cuenta con una Pol√≠tica de Protecci√≥n de Datos Personales cuyo objetivo es atender a las disposiciones vigentes y aplicables de la ley N¬∫ 19.628.</p>
                        
                        <h4>3.1 Generalidades</h4>
                        <p><strong>a)</strong> Considerando la inmunizaci√≥n es subsidiado por una empresa farmac√©utica, se informa a usted que sus datos podr√°n ser compartidos con la empresa farmac√©utica de forma agregada, lo anterior con fines estad√≠sticos y conforme a la legislaci√≥n vigente.</p>
                        
                        <p><strong>b)</strong> As√≠, tambi√©n autoriza a su m√©dico tratante para que directa o indirectamente almacene, use y transfiera los datos que usted suministre, para fines estad√≠sticos, administrativos, m√©dicos o cient√≠ficos.</p>
                        
                        <p><strong>c)</strong> Todas entidades con las cuales se comparta sus datos personales, est√°n en la obligaci√≥n de respetar la confidencialidad de la informaci√≥n que usted haya suministrado, as√≠ como dar cumplimiento a las disposiciones de la ley de protecci√≥n de datos personales.</p>
                        
                        <p><strong>d)</strong> El paciente tiene derecho a actualizar, acceder, incluir, sustituir, rectificar, o excluir informaci√≥n que previamente haya entregado a Serproen.</p>
                        
                        <p><strong>e)</strong> Ante cualquier duda o consulta respecto el consentimiento informado, derechos que asisten en virtud de la ley. Cont√°ctenos al tel√©fono +569 40067468 o al correo electr√≥nico gestionlaboratorios@serproen.cl</p>
                        
                        <h4>4. Consentimiento Informado</h4>
                        <p>Usted declara mediante la aceptaci√≥n de este documento, conocer y haber sido informado sobre el alcance y metodolog√≠a para la administraci√≥n de vacuna, presentada en forma resumida en los apartados N¬∫1 y N¬∫2. Adem√°s de la existencia de una pol√≠tica de Protecci√≥n de datos personales que se ajusta a las disposiciones de la ley N¬∫ 19.628.</p>
                        <p>Del mismo modo, declaro que se me permiti√≥ realizar preguntas sobre el procedimiento durante su realizaci√≥n.</p>
                    </div>
                    
                    <p style="margin-top: 25px; margin-bottom: 25px; font-weight: 600; color: #333; text-align: center;">
                        La administraci√≥n de vacuna ha sido solicitada por su m√©dico tratante.
                    </p>
                    
                    <form id="consentForm">
                        <div class="consent-fields">
                            <div class="form-group">
                                <label for="doctorName">Nombre del m√©dico tratante *</label>
                                <input type="text" id="doctorName" name="doctorName" placeholder="Dr. Juan P√©rez" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="patientNameConsent">Nombre completo del paciente *</label>
                                <input type="text" id="patientNameConsent" name="patientNameConsent" placeholder="Mar√≠a Gonz√°lez L√≥pez" required>
                            </div>
                            
                            <div class="consent-checkbox">
                                <input type="checkbox" id="consentAccept" name="consentAccept" required>
                                <label for="consentAccept">Acepto los t√©rminos del consentimiento informado</label>
                            </div>
                        </div>
                        
                        <button type="submit" class="form-submit-button" id="consentSubmitBtn" disabled>Continuar</button>
                        <a class="form-back-link" style="display: block; margin-top: 15px; text-align: center;" onclick="backToMedicationFromConsent()">‚Üê Volver a selecci√≥n de medicamento</a>
                    </form>
                </div>

                <!-- Formulario de datos del paciente -->
                <div class="faq-form" id="faqForm">
                    <a class="form-back-link" onclick="backToMedicationSelection()">‚Üê Volver a selecci√≥n de medicamento</a>
                    <h3>Datos del Paciente</h3>
                    <form id="patientForm">
                        <div class="form-group">
                            <label for="rut">RUT *</label>
                            <input type="text" id="rut" name="rut" placeholder="12.345.678-9" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Correo de contacto *</label>
                            <input type="email" id="email" name="email" placeholder="ejemplo@correo.com" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Tel√©fono de contacto *</label>
                            <input type="tel" id="phone" name="phone" placeholder="+56 9 1234 5678" required>
                        </div>
                        <div class="form-group">
                            <label for="birthdate">Fecha de nacimiento *</label>
                            <input type="date" id="birthdate" name="birthdate" required>
                        </div>
                        <button type="submit" class="form-submit-button">Continuar</button>
                    </form>
                </div>

                <!-- Pantalla de preguntas -->
                <div class="faq-questions" id="faqQuestions">
                    <h3>Has seleccionado: MOUNJARO</h3>
                    <p style="text-align: center; color: #666; margin-bottom: 20px;">¬øEn qu√© puedo ayudarte?</p>
                    <button class="faq-question-button" onclick="showAnswer('que-es')">
                        ¬øQu√© es Mounjaro?
                    </button>
                    <button class="faq-question-button" onclick="showAnswer('como-aplicar')">
                        ¬øC√≥mo me aplico el producto?
                    </button>
                    <button class="faq-question-button" onclick="showAnswer('agujas')">
                        ¬øD√≥nde consigo agujas?
                    </button>
                    <button class="faq-question-button" onclick="showAnswer('farmacovigilancia')">
                        Tuve un problema al utilizar el medicamento
                    </button>
                    <button class="back-button" onclick="backToWelcome()">‚Üê Volver al men√∫ anterior</button>
                    <p style="text-align: center; color: #666; margin-top: 30px;">
                        Conoce m√°s informaci√≥n sobre tu patolog√≠a y/o tratamiento 
                        <a href="https://mounjaro.lilly.com/es/que-es-mounjaro" target="_blank" style="color: #ff0032; font-weight: 600; text-decoration: none;">AQU√ç</a>.
                    </p>
                </div>

                <!-- Respuestas -->
                <div class="faq-answer" id="answer-que-es">
                    <h3>¬øQu√© es Mounjaro?</h3>
                    <div class="video-container">
                        <iframe 
                            src="https://www.youtube.com/embed/yMJ5YdEnS9w" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen>
                        </iframe>
                    </div>
                    <p>Mounjaro es un medicamento innovador dise√±ado para ayudarte en tu tratamiento. Mira el video para conocer m√°s detalles.</p>
                    <button class="back-button" onclick="backToQuestions()">‚Üê Volver a preguntas</button>
                </div>

                <div class="faq-answer" id="answer-como-aplicar">
                    <h3>¬øC√≥mo me aplico el producto?</h3>
                    <div class="video-container">
                        <iframe 
                            src="https://www.youtube.com/embed/iSWubSlzPbc" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen>
                        </iframe>
                    </div>
                    <p>En este video aprender√°s paso a paso c√≥mo aplicar correctamente Mounjaro de forma segura y efectiva.</p>
                    <button class="back-button" onclick="backToQuestions()">‚Üê Volver a preguntas</button>
                </div>

                <div class="faq-answer" id="answer-agujas">
                    <h3>¬øD√≥nde consigo agujas?</h3>
                    <p>En Adium Chile contamos con <strong>programas de beneficios</strong> especiales para nuestros pacientes:</p>
                    <ul>
                        <li><strong>Programa de Entrega de Agujas:</strong> Puedes solicitar agujas compatibles directamente a trav√©s de nuestro programa de apoyo.</li>
                        <li><strong>Descuentos Especiales:</strong> Accede a precios preferenciales en farmacias asociadas.</li>
                        <li><strong>Entregas a Domicilio:</strong> Recibe tus insumos en la comodidad de tu hogar sin costo adicional.</li>
                    </ul>
                    <p>Para m√°s informaci√≥n sobre estos beneficios, contacta a nuestro equipo de apoyo o consulta con tu m√©dico tratante.</p>
                    <button class="back-button" onclick="backToQuestions()">‚Üê Volver a preguntas</button>
                </div>

                <div class="faq-answer" id="answer-farmacovigilancia">
                    <h3>Formulario de farmacovigilancia</h3>
                    <p>La farmacovigilancia es fundamental para garantizar la seguridad de los medicamentos. Si has experimentado alg√∫n efecto adverso o evento inesperado, por favor rep√≥rtalo.</p>
                    <p>Tu reporte es confidencial y nos ayuda a mejorar la seguridad de todos nuestros pacientes.</p>
                    <p style="text-align: center; margin-top: 30px;">
                        <a href="https://adium.creoscro.com/Safety/PublicGeneral" target="_blank" class="external-link-button">
                            Ir al formulario de farmacovigilancia ‚Üí
                        </a>
                    </p>
                    <button class="back-button" onclick="backToQuestions()">‚Üê Volver a preguntas</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== PESTA√ëAS ==========
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabName = tab.getAttribute('data-tab');
                
                // Remover active de todas las pesta√±as
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(tc => tc.classList.remove('active'));
                
                // Activar pesta√±a seleccionada
                tab.classList.add('active');
                document.getElementById(`tab-${tabName}`).classList.add('active');
            });
        });

        // ========== PESTA√ëA 1: CHAT IA ==========
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const typingIndicator = document.getElementById('typingIndicator');

        const userId = 'user_' + Math.random().toString(36).substring(7);
        let isProcessing = false;

        // Agregar mensaje
        function addMessage(role, content) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            contentDiv.textContent = content;
            
            messageDiv.appendChild(contentDiv);
            
            chatMessages.insertBefore(messageDiv, typingIndicator);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Mostrar/ocultar indicador de escritura
        function showTyping(show) {
            typingIndicator.classList.toggle('active', show);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Enviar mensaje
        async function sendMessage() {
            const message = messageInput.value.trim();

            if (!message || isProcessing) {
                return;
            }

            isProcessing = true;
            sendButton.disabled = true;
            messageInput.disabled = true;

            addMessage('user', message);
            messageInput.value = '';
            showTyping(true);

            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        userId: userId,
                        message: message
                    })
                });

                const data = await response.json();
                showTyping(false);

                if (data.error) {
                    addMessage('assistant', `‚ö†Ô∏è Error: ${data.response || data.error}`);
                } else {
                    addMessage('assistant', data.response);
                }

            } catch (error) {
                showTyping(false);
                addMessage('assistant', '‚ùå Error de conexi√≥n. Por favor, intenta de nuevo.');
                console.error('Error:', error);
            } finally {
                isProcessing = false;
                sendButton.disabled = false;
                messageInput.disabled = false;
                messageInput.focus();
            }
        }

        // Event listeners para chat IA
        sendButton.addEventListener('click', sendMessage);
        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Limpiar chat
        function clearChat() {
            const messages = chatMessages.querySelectorAll('.message');
            messages.forEach(msg => msg.remove());
        }

        // ========== PESTA√ëA 2: FAQ ==========
        function selectMedication() {
            document.getElementById('faqWelcome').style.display = 'none';
            document.getElementById('testBox').classList.add('active');
        }

        // Habilitar/deshabilitar bot√≥n de continuar seg√∫n checkbox
        document.getElementById('consentAccept').addEventListener('change', function() {
            document.getElementById('consentSubmitBtn').disabled = !this.checked;
        });

        // Manejar env√≠o del consentimiento
        document.getElementById('consentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const consentData = {
                doctorName: document.getElementById('doctorName').value,
                accepted: document.getElementById('consentAccept').checked,
                patientName: document.getElementById('patientNameConsent').value
            };
            
            console.log('Consentimiento:', consentData);
            
            // Ocultar cuadro de consentimiento y mostrar formulario de datos
            document.getElementById('testBox').classList.remove('active');
            document.getElementById('faqForm').classList.add('active');
        });

        // Manejar env√≠o del formulario de datos del paciente
        document.getElementById('patientForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Aqu√≠ podr√≠as guardar los datos si fuera necesario
            const formData = {
                rut: document.getElementById('rut').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                birthdate: document.getElementById('birthdate').value
            };
            
            console.log('Datos del paciente:', formData);
            
            // Ocultar formulario y mostrar preguntas
            document.getElementById('faqForm').classList.remove('active');
            document.getElementById('faqQuestions').classList.add('active');
        });

        function showAnswer(answerId) {
            // Ocultar preguntas
            document.getElementById('faqQuestions').classList.remove('active');
            
            // Ocultar todas las respuestas
            document.querySelectorAll('.faq-answer').forEach(answer => {
                answer.classList.remove('active');
            });
            
            // Mostrar respuesta seleccionada
            document.getElementById(`answer-${answerId}`).classList.add('active');
        }

        function backToQuestions() {
            // Ocultar todas las respuestas
            document.querySelectorAll('.faq-answer').forEach(answer => {
                answer.classList.remove('active');
            });
            
            // Mostrar preguntas
            document.getElementById('faqQuestions').classList.add('active');
        }

        function backToWelcome() {
            // Ocultar preguntas
            document.getElementById('faqQuestions').classList.remove('active');
            
            // Limpiar formulario
            document.getElementById('patientForm').reset();
            
            // Mostrar bienvenida
            document.getElementById('faqWelcome').style.display = 'block';
        }

        function backToMedicationSelection() {
            // Ocultar formulario
            document.getElementById('faqForm').classList.remove('active');
            
            // Limpiar formulario
            document.getElementById('patientForm').reset();
            
            // Mostrar bienvenida
            document.getElementById('faqWelcome').style.display = 'block';
        }

        function backToMedicationFromConsent() {
            // Ocultar consentimiento
            document.getElementById('testBox').classList.remove('active');
            
            // Limpiar formulario de consentimiento
            document.getElementById('consentForm').reset();
            document.getElementById('consentSubmitBtn').disabled = true;
            
            // Mostrar bienvenida
            document.getElementById('faqWelcome').style.display = 'block';
        }
    </script>
</body>
</html>
